import numpy as np
import matplotlib.pyplot as plt

X = np.array([[0, 1], [8, 1], [0, 1], [8, 1]])
y = np.array([10, 7, 7, 6])

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä—è–º–æ–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ.
# w - –≤–µ–∫—Ç–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ [k, m].
w = np.linalg.inv(X.T @ X) @ X.T @ y

# –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å—Ä–∞–∑—É –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.
k, m = np.linalg.inv(X.T @ X) @ X.T @ y

# –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ –º–æ–∂–Ω–æ –ø–æ —Ñ–æ—Ä–º—É–ª–µ –ø—Ä—è–º–æ–π.
x_test = 6
y_pred = w[0] * x_test + w[1]
print(f"–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ {x_test} —á–∞—Å–∞(–æ–≤) –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —Å–º–µ–Ω—ã:")
print(y_pred)

# –ö–æ–¥ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞, –µ–≥–æ –º–æ–∂–Ω–æ –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å.
for i in range(len(y) // 2):
    plt.scatter(X[i::2, 0], y[i::2], s=100, label=f"–î–µ–Ω—å {i+1}")
plt.scatter(x_test, y_pred, zorder=10, s=100, label="–¢–µ—Å—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞ (x_test, y_pred)")

x_min = -1; x_max = 9
y_min = x_min * w[0] + w[1]
y_max = x_max * w[0] + w[1]

plt.plot(
    [x_min, x_max],
    [y_min, y_max],
    linewidth=3,
    c="C4",
    label="–ù–∞–∏–ª—É—á—à–∞—è –ø—Ä—è–º–∞—è",
)
plt.grid()
plt.ylim(-1, 11.5)
plt.xlim(-1, 9)
plt.ylabel("üòä", rotation=0, fontsize=25, labelpad=20)
plt.xlabel("–ß–∞—Å—ã –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —Å–º–µ–Ω—ã, t", fontsize=15)
plt.legend(loc=3)
plt.show()

###### EXERCISE 2 ######

# –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä—è–º–æ–π –¥–ª—è –∑–∞–¥–∞–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫.
# –í–µ–∫—Ç–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π w. –°–¥–µ–ª–∞–π—Ç–µ
# –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è x = 1.5. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π result.

import numpy as np
import matplotlib.pyplot as plt
X = np.array([[2, 1], [3, 1], [4, 1], [2.5, 1], [3.5, 1]])
y = np.array([1, 3, 2, 4.5, 3])

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä—è–º–æ–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ.
# w - –≤–µ–∫—Ç–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ [k, m].
w = np.linalg.inv(X.T @ X) @ X.T @ y

# –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å—Ä–∞–∑—É –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.
k, m = np.linalg.inv(X.T @ X) @ X.T @ y

x_test = 1.5
result = w[0] * x_test + w[1]
print(result)

# –ö–æ–¥ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞, –µ–≥–æ –º–æ–∂–Ω–æ –Ω–µ –º–µ–Ω—è—Ç—å.
x_min = 1
x_max = 5
y_min = x_min * w[0] + w[1]
y_max = x_max * w[0] + w[1]

plt.scatter(X[:, 0], y, s=100)
plt.vlines(x_test, 0, 5, linestyle='--', color='C1', label="–¢–µ—Å—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞ x_test")
plt.scatter(x_test, result, zorder=10, s=100)

plt.plot(
    [x_min, x_max],
    [y_min, y_max],
    linewidth=3,
    c="C1",
)
plt.xlabel("$x$", fontsize=15)
plt.ylabel("$y$", fontsize=15, rotation=0, labelpad=15)
plt.xlim(x_min, x_max)
plt.ylim(0, 5)
plt.grid()
plt.show()

# –§–æ—Ä–º—É–ª–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–æ–ª—É—á–∏–ª–∏, –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –Ω–∞–±–æ—Ä—É —Ç–æ—á–µ–∫
# –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä—è–º—É—é –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
# –≤ –Ω–æ–≤—ã—Ö —Ç–æ—á–∫–∞—Ö. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –ø—Ä–∏–º–µ—Ä —Å —Ç–æ—á–∫–∞–º–∏ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏,
# –∏ —ç—Ç—É –∂–µ —Ñ–æ—Ä–º—É–ª—É –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏
# –±–æÃÅ–ª—å—à–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.

import numpy as np
X = np.array([[0, 1, 1], [8, 2, 1], [0, 0, 1], [8, 1, 1]]) # –µ–¥–∏–Ω–∏—Ü–∞ ‚Äî –¥–ª—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ m
y = np.array([10, 7, 7, 6])

w = np.linalg.inv(X.T @ X) @ X.T @ y # –Ω–∞–∏–ª—É—á—à–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
x = np.array([4, 1, 1]) # (4 —á–∞—Å–∞, 1 –ø—Ä–∏—ë–º –ø–∏—â–∏, 1)

result = x @ w
print(f"–°–æ—Å—Ç–æ—è–Ω–∏–µ –ú–∞–∫—Å–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –¥–Ω—è –ø–æ—Å–ª–µ –æ–¥–Ω–æ–≥–æ –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏: {result}")

# –ß—Ç–æ —ç—Ç–æ –∑–∞ –±—É–∫–≤–∞ f –ø–µ—Ä–µ–¥ —Å—Ç—Ä–æ–∫–æ–π –≤ print?

# –¢–∞–∫–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤ Python –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è f-—Å—Ç—Ä–æ–∫–æ–π. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç
# –≤—Å—Ç–∞–≤–∏—Ç—å –≤ —Ç–µ–∫—Å—Ç–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö).
# –î–ª—è —ç—Ç–æ–≥–æ –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—Å—Ç–∞ –Ω—É–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
# –≤ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö.

import numpy as np
X = np.array([[0, 1, 1], [8, 2, 1], [0, 0, 1], [8, 1, 1]])
y = np.array([10, 7, 7, 6])

w = np.linalg.inv(X.T @ X) @ X.T @ y
X_test = np.array([[0, 0, 1], [4, 1, 1], [8, 1, 1]])

result = X_test @ w

print(f"–°–æ—Å—Ç–æ—è–Ω–∏–µ –ú–∞–∫—Å–∞ –≤ –Ω–∞—á–∞–ª–µ –¥–Ω—è: {result[0]:.3f}")
print(f"–°–æ—Å—Ç–æ—è–Ω–∏–µ –ú–∞–∫—Å–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –¥–Ω—è: {result[1]:.3f}")
print(f"–°–æ—Å—Ç–æ—è–Ω–∏–µ –ú–∞–∫—Å–∞ –≤ –∫–æ–Ω—Ü–µ –¥–Ω—è: {result[2]:.3f}")

# –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 3
# –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞ –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Ç–æ—á–µ–∫ –≤
# –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π w.
# –ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è —Ç–æ—á–∫–∏ x_test, —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –≤
# –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π result. –í—ã–≤–µ–¥–∏—Ç–µ –Ω–∞ —ç–∫—Ä–∞–Ω –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
# w –∏ result.

import numpy as np

X = np.array(
    [
        [-5, 4, 1, 1],
        [4, 1, -1, 1],
        [-4, 2, -5, 1],
        [3, -1, 1, 1],
        [-4, -2, 1, 1],
        [2, 3, 3, 1],
        [-2, -2, 2, 1],
        [-5, -1, 1, 1],
        [-3, -2, -5, 1],
        [-1, -5, -3, 1]
    ]
)
y = np.array(
    [
        -0.32581626,
        -1.43382938,
        3.97955347,
        1.87893544,
        7.0873269,
        1.27071511,
        7.82060681,
        9.94167137,
        12.08570158,
        13.52843795
    ]
)

x_test = [-3, 1, 1, 1]

w = np.linalg.inv(X.T @ X) @ X.T @ y

result = x_test @ w

print(result)
print(w)
