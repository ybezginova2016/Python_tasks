import numpy as np
import matplotlib.pyplot as plt

X = np.array([[0, 1], [8, 1], [0, 1], [8, 1]])
y = np.array([10, 7, 7, 6])

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä—è–º–æ–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ.
# w - –≤–µ–∫—Ç–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ [k, m].
w = np.linalg.inv(X.T @ X) @ X.T @ y

# –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å—Ä–∞–∑—É –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.
k, m = np.linalg.inv(X.T @ X) @ X.T @ y

# –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ –º–æ–∂–Ω–æ –ø–æ —Ñ–æ—Ä–º—É–ª–µ –ø—Ä—è–º–æ–π.
x_test = 6
y_pred = w[0] * x_test + w[1]
print(f"–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ {x_test} —á–∞—Å–∞(–æ–≤) –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —Å–º–µ–Ω—ã:")
print(y_pred)

# –ö–æ–¥ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞, –µ–≥–æ –º–æ–∂–Ω–æ –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å.
for i in range(len(y) // 2):
    plt.scatter(X[i::2, 0], y[i::2], s=100, label=f"–î–µ–Ω—å {i+1}")
plt.scatter(x_test, y_pred, zorder=10, s=100, label="–¢–µ—Å—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞ (x_test, y_pred)")

x_min = -1; x_max = 9
y_min = x_min * w[0] + w[1]
y_max = x_max * w[0] + w[1]

plt.plot(
    [x_min, x_max],
    [y_min, y_max],
    linewidth=3,
    c="C4",
    label="–ù–∞–∏–ª—É—á—à–∞—è –ø—Ä—è–º–∞—è",
)
plt.grid()
plt.ylim(-1, 11.5)
plt.xlim(-1, 9)
plt.ylabel("üòä", rotation=0, fontsize=25, labelpad=20)
plt.xlabel("–ß–∞—Å—ã –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —Å–º–µ–Ω—ã, t", fontsize=15)
plt.legend(loc=3)
plt.show()

###### EXERCISE 2 ######
# –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2
# –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä—è–º–æ–π –¥–ª—è –∑–∞–¥–∞–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫.
# –í–µ–∫—Ç–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π w. –°–¥–µ–ª–∞–π—Ç–µ
# –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è x = 1.5.x=1.5. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
# result.
import numpy as np
import matplotlib.pyplot as plt
X = np.array([[2, 1], [3, 1], [4, 1], [2.5, 1], [3.5, 1]])
y = np.array([1, 3, 2, 4.5, 3])

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä—è–º–æ–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ.
# w - –≤–µ–∫—Ç–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ [k, m].
w = np.linalg.inv(X.T @ X) @ X.T @ y

# –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å—Ä–∞–∑—É –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.
k, m = np.linalg.inv(X.T @ X) @ X.T @ y

x_test = 1.5
result = w[0] * x_test + w[1]
print(result)

# –ö–æ–¥ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞, –µ–≥–æ –º–æ–∂–Ω–æ –Ω–µ –º–µ–Ω—è—Ç—å.
x_min = 1; x_max = 5
y_min = x_min * w[0] + w[1]
y_max = x_max * w[0] + w[1]

plt.scatter(X[:, 0], y, s=100)
plt.vlines(x_test, 0, 5, linestyle='--', color='C1', label="–¢–µ—Å—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞ x_test")
plt.scatter(x_test, result, zorder=10, s=100)

plt.plot(
    [x_min, x_max],
    [y_min, y_max],
    linewidth=3,
    c="C1",
)
plt.xlabel("$x$", fontsize=15)
plt.ylabel("$y$", fontsize=15, rotation=0, labelpad=15)
plt.xlim(x_min, x_max)
plt.ylim(0, 5)
plt.grid()
plt.show()

# –§–æ—Ä–º—É–ª–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–æ–ª—É—á–∏–ª–∏, –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –Ω–∞–±–æ—Ä—É —Ç–æ—á–µ–∫
# –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä—è–º—É—é –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
# –≤ –Ω–æ–≤—ã—Ö —Ç–æ—á–∫–∞—Ö. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –ø—Ä–∏–º–µ—Ä —Å —Ç–æ—á–∫–∞–º–∏ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏,
# –∏ —ç—Ç—É –∂–µ —Ñ–æ—Ä–º—É–ª—É –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏
# –±–æÃÅ–ª—å—à–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.